# Ценообразование

## Условие задачи

В БД храниться список товаров (500 000 позиций), и 10 справочных таблиц для атрибутов товара (до 10000 строк). Одно
значение справочника может быть присвоено нескольким товарам Необходимо разработать прототип приложения со следующими
функциями отображение списка товаров фильтрация товара по любому атрибуту, полнотекстовый поиск товара по любому
атрибуту Все функции должны быть задокументированы Swagger. Необходимо реализовать обработчик ошибок.

## Особенности реализации

Создана миграция средствами flyway. При первом запуске происходит инициализация таблиц:

1) pricing - содержит информацию по продуктам. Таблицы денормализованна, все идентификаторы и значения атрибутов хранит
   в себе, без ссылок на сторонние таблицы по внешним ключам. Таким способом получаем более быстрый поиск\фильтрацию по
   таблице, так как нет inner join'ов. Созданы индексы на все атрибуты, для ускорения фильтрации.
   
2) таблицы атрибутов, пример - first_attribute.

## Конфигурация приложения

Для конфигурации необходимо задать параметры подключения к эталонной БД в application.yml или как параметры запуска приложения.
1) spring.datasource.url
2) spring.datasource.username
2) spring.datasource.password

## Запуск приложения

`gradlew bootRun`

## Работа приложения

Поиск продукта доступен по адресу `http://localhost:8080/api/pricing/find-all` метод `POST`

Так как значений выборки может быть много, добавлена пагинации в запрос, которая передается средствами параметров URL:
1) page - страница отображения
2) size - кол-во элементов на странице
3) sort - сортировка по указанному атрибуту (asc|desc)

Пример запроса с фильтрацией по нескольким атрибутам с разными условиями.
В таблицу добавлена единственная запись для демонстрации работы приложения:

| id          | productName | first_attribute_id | first_attribute_name |
| ----------- | ----------- | ------------------ | -------------------- |
| 1           | Молоко      | 1                  | Пакет                |

Для фильтрации по атрибутам необходимо передать тело запроса:
```json
[
   {
      "key": "productName",
      "searchCondition": "LIKE",
      "value": "олоко"
   },
   {
      "key": "firstAttributeName",
      "searchCondition": "EQUALS",
      "value": "Пакет"
   }
]
```

## Описание swagger

1) http://localhost:8080/swagger-ui.html - swagger url. По данной ссылке хранится UI Api с описанными моделями.
2) http://localhost:8080/v2/api-docs - generated openapi url. По данной ссылке хранится сгенерированный openapi 
   в формате json.